<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ุงููุนูุฏ ุงูุฃููู ุงูุนุงูู ููุชุฏุฑูุจ | ุชุฏุฑูุจ ุงูุฃูู ุงูุณูุจุฑุงูู</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-sA+e2r3y9GqX4x3f3j8YwqgVf2b0J3u0y2x0Jm0p6uI=" crossorigin=""/>
  <style>
    body { font-family: "Tahoma", "Segoe UI", Arial, sans-serif; background:#f7f7fb; color:#111; padding:16px; line-height:1.7; }
    h1,h2,h3 { color:#0b6efd; }
    .card { background:#fff; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.06); padding:16px; margin-bottom:16px; }
    #map { height: 380px; border-radius:10px; margin-top:12px; }
    button { padding:10px 14px; border-radius:8px; border:0; background:#0b6efd; color:#fff; cursor:pointer; font-weight:600; }
    button[disabled] { background:#9fb8ff; cursor:not-allowed; }
    .warn { color:#b33; font-weight:600; }
    .muted { color:#666; font-size:0.95rem; }
    label { display:flex; gap:8px; align-items:center; }
    header { text-align:center; margin-bottom:20px; }
    header h1 { margin:0; }
    footer { text-align:center; margin-top:20px; font-size:0.9rem; color:#555; }
  </style>
</head>
<body>

  <header>
    <h1>ุงููุนูุฏ ุงูุฃููู ุงูุนุงูู ููุชุฏุฑูุจ</h1>
    <h2>ุจุฑูุงูุฌ ุงูุฃูู ุงูุณูุจุฑุงูู</h2>
    <h3>ุนุฑุถ ุชุฏุฑูุจู: ูุดุงุฑูุฉ ุงููููุน ุงูุฌุบุฑุงูู</h3>
  </header>

  <div class="card">
    <h3>๐ ุชุนูููุงุช ููุทูุงุจ</h3>
    <ul>
      <li>ุงูุบุฑุถ ูู ูุฐุง ุงูุชูุฑูู ูู ุงูุชุฏุฑูุจ ุนูู <strong>ููููู ุชุญุฏูุฏ ุงููููุน</strong> ุจุงุณุชุฎุฏุงู ุชูููุงุช ุงูููุจ ุงูุญุฏูุซุฉ.</li>
      <li>ุงูุชูุฑูู ูุชู ูู ุจูุฆุฉ ุชุนููููุฉ ุขููุฉ ููุง ูุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู ุฃู ุทุฑู ุฎุงุฑุฌู.</li>
      <li>ุงููุดุงุฑูุฉ <strong>ุทูุนูุฉ ุจุงููุงูู</strong>ุ ูููููู ุฅููุงููุง ุฃู ุฑูุถ ุงูุฅุฐู ูู ุฃู ููุช.</li>
      <li>ุงููุฏู ูู ููู ููููุฉ ุนูู <strong>Geolocation API</strong> ูุนุฑุถ ุงููุชูุฌุฉ ุนูู <strong>ุฎุฑูุทุฉ ุชูุงุนููุฉ</strong>.</li>
    </ul>
  </div>

  <div class="card">
    <h3>โ๏ธ ูููุฐุฌ ุงูููุงููุฉ</h3>
    <form id="consentForm">
      <label>
        <input type="checkbox" id="consentCheckbox" />
        ุฃูุงูู ุนูู ุงููุดุงุฑูุฉ ูู ูุฐุง ุงูุชูุฑูู ุงูุชุนูููู ุงูุฎุงุต ุจุงูุฃูู ุงูุณูุจุฑุงูู.
      </label>
      <p class="muted">ุจุนุฏ ุงูููุงููุฉ ููููู ุงูุถุบุท ุนูู ุงูุฒุฑ ูุทูุจ ุงููููุน ูู ุงููุชุตูุญ ูุนุฑุถู ุนูู ุงูุฎุฑูุทุฉ.</p>
    </form>
    <div style="margin-top:10px;">
      <button id="getLocBtn" disabled>๐ ุทูุจ ุงููููุน</button>
      <button id="clearBtn" style="background:#6c757d; margin-left:8px;">๐ ุฅุนุงุฏุฉ ุชุนููู</button>
    </div>
    <p id="status" class="muted" style="margin-top:8px;"></p>
  </div>

  <div class="card">
    <h3>๐ ุงููุชูุฌุฉ</h3>
    <p id="info" class="muted">ูู ูุชู ุทูุจ ุงููููุน ุจุนุฏ.</p>
    <div id="map" style="display:none;"></div>
  </div>

  <footer>
    ยฉ ุงููุนูุฏ ุงูุฃููู ุงูุนุงูู ููุชุฏุฑูุจ โ ูุญุฏุฉ ุงูุฃูู ุงูุณูุจุฑุงูู  
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-QVdVQao6bq3Zl3gF2z2h3j9p1Yh2sd0x5v+f3v9Qm+E=" crossorigin=""></script>
  <script>
    const consentCheckbox = document.getElementById('consentCheckbox');
    const getLocBtn = document.getElementById('getLocBtn');
    const statusEl = document.getElementById('status');
    const infoEl = document.getElementById('info');
    const mapDiv = document.getElementById('map');
    const clearBtn = document.getElementById('clearBtn');

    // ุชูุนูู ุงูุฒุฑ ุนูุฏ ุงูููุงููุฉ
    consentCheckbox.addEventListener('change', () => {
      getLocBtn.disabled = !consentCheckbox.checked;
    });

    // ุฅุนุงุฏุฉ ุชุนููู
    clearBtn.addEventListener('click', () => {
      consentCheckbox.checked = false;
      getLocBtn.disabled = true;
      statusEl.textContent = '';
      infoEl.textContent = 'ูู ูุชู ุทูุจ ุงููููุน ุจุนุฏ.';
      mapDiv.style.display = 'none';
      if (window._demoMap) {
        window._demoMap.remove();
        window._demoMap = null;
      }
    });

    // ุงูุชุญูู ูู ุฏุนู ุงููุชุตูุญ
    if (!('geolocation' in navigator)) {
      statusEl.innerHTML = '<span class="warn">โ๏ธ ุงููุชุตูุญ ูุง ูุฏุนู ุฎุงุตูุฉ ุชุญุฏูุฏ ุงููููุน.</span>';
      getLocBtn.disabled = true;
    }

    // ุทูุจ ุงููููุน
    getLocBtn.addEventListener('click', () => {
      statusEl.textContent = 'โณ ุทูุจ ุฅุฐู ุงููููุน ูู ุงููุชุตูุญ...';
      infoEl.textContent = 'ุงูุฑุฌุงุก ุงูุณูุงุญ ูููุชุตูุญ ุจูุดุงุฑูุฉ ุงููููุน.';
      navigator.geolocation.getCurrentPosition(onSuccess, onError, {
        enableHighAccuracy: true,
        timeout: 20000,
        maximumAge: 0
      });
    });

    function onSuccess(pos) {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      const acc = pos.coords.accuracy;
      statusEl.textContent = 'โ ุชู ุงูุญุตูู ุนูู ุงููููุน ุจูุฌุงุญ.';
      infoEl.innerHTML = `๐ ุงูุฅุญุฏุงุซูุงุช: <strong>ุฎุท ุงูุนุฑุถ</strong> ${lat.toFixed(6)}, <strong>ุฎุท ุงูุทูู</strong> ${lon.toFixed(6)} โ ุจุฏูุฉ ุชูุฑูุจูุฉ ยฑ${Math.round(acc)} ูุชุฑ.`;

      mapDiv.style.display = 'block';
      if (window._demoMap) {
        window._demoMap.remove();
        window._demoMap = null;
      }
      const map = L.map('map').setView([lat, lon], 15);
      window._demoMap = map;
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: 'ยฉ OpenStreetMap'
      }).addTo(map);
      const marker = L.marker([lat, lon]).addTo(map);
      marker.bindPopup(`๐ ูููุน ุงูุฌูุงุฒ<br>ุงูุฏูุฉ โ ${Math.round(acc)} ู`).openPopup();
    }

    function onError(err) {
      console.warn('Geolocation error:', err);
      switch(err.code) {
        case err.PERMISSION_DENIED:
          statusEl.innerHTML = '<span class="warn">โ ุชู ุฑูุถ ุงูุฅุฐู.</span> ุงูุฑุฌุงุก ุงูุณูุงุญ ููุตูุญุฉ ุจุงููุตูู ุฅูู ุงููููุน.';
          infoEl.textContent = 'ุงููููุน ูู ูุชู ุงูุญุตูู ุนููู ุจุณุจุจ ุฑูุถ ุงูุฅุฐู.';
          break;
        case err.POSITION_UNAVAILABLE:
          statusEl.innerHTML = '<span class="warn">โ๏ธ ุงููููุน ุบูุฑ ูุชุงุญ.</span>';
          infoEl.textContent = 'ุชุนุฐุฑ ุงูุญุตูู ุนูู ุงููููุน (ุบูุฑ ูุชุงุญ).';
          break;
        case err.TIMEOUT:
          statusEl.innerHTML = '<span class="warn">โ ุงูุชูุช ูููุฉ ุงูุทูุจ.</span>';
          infoEl.textContent = 'ุงูุชูุช ูููุฉ ุงูุญุตูู ุนูู ุงููููุน. ุญุงูู ูุฑุฉ ุฃุฎุฑู.';
          break;
        default:
          statusEl.innerHTML = '<span class="warn">โ๏ธ ุฎุทุฃ ุบูุฑ ูุนุฑูู.</span>';
          infoEl.textContent = 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุญุงููุฉ ุงูุญุตูู ุนูู ุงููููุน.';
      }
    }
  </script>
</body>
</html>
